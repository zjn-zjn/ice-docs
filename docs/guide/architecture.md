---
title: Ice æ¶æ„æ¦‚è§ˆ - Server/Client æ¶æ„è¯´æ˜
description: äº†è§£ Ice è§„åˆ™å¼•æ“çš„æ•´ä½“æ¶æ„è®¾è®¡ï¼ŒåŒ…æ‹¬ Serverã€Clientã€å…±äº«å­˜å‚¨çš„å·¥ä½œåŸç†å’Œéƒ¨ç½²æ–¹å¼ã€‚
keywords: Iceæ¶æ„,è§„åˆ™å¼•æ“æ¶æ„,Server Client,å…±äº«å­˜å‚¨,åˆ†å¸ƒå¼éƒ¨ç½²
head:
  - - meta
    - property: og:title
      content: Ice æ¶æ„æ¦‚è§ˆ - Server/Client æ¶æ„è¯´æ˜
  - - meta
    - property: og:description
      content: äº†è§£ Ice è§„åˆ™å¼•æ“çš„æ•´ä½“æ¶æ„è®¾è®¡ï¼ŒåŒ…æ‹¬ Serverã€Clientã€å…±äº«å­˜å‚¨çš„å·¥ä½œåŸç†ã€‚
---

# Ice æ¶æ„æ¦‚è§ˆ

> ç†è§£ Ice çš„ Server + Client + å…±äº«å­˜å‚¨æ¶æ„æ¨¡å¼

## æ•´ä½“æ¶æ„

Ice é‡‡ç”¨ **é›¶å¤–éƒ¨ä¾èµ–** çš„æç®€æ¶æ„ï¼Œé€šè¿‡æ–‡ä»¶ç³»ç»Ÿå®ç°é…ç½®å­˜å‚¨å’ŒåŒæ­¥ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å…±äº«å­˜å‚¨ç›®å½• (ice-data/)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  apps/  â”‚  â”‚ bases/  â”‚  â”‚ confs/  â”‚  â”‚  versions/  â”‚    â”‚
â”‚  â”‚ åº”ç”¨é…ç½® â”‚  â”‚ è§„åˆ™é…ç½® â”‚  â”‚ èŠ‚ç‚¹é…ç½® â”‚  â”‚  ç‰ˆæœ¬å¢é‡   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â–² å†™å…¥é…ç½®                          â–² è¯»å–é…ç½®
        â”‚                                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Ice Server  â”‚                   â”‚   Ice Client  â”‚
â”‚  (é…ç½®ç®¡ç†)    â”‚                   â”‚  (è§„åˆ™æ‰§è¡Œ)    â”‚
â”‚               â”‚                   â”‚               â”‚
â”‚ â€¢ Web ç®¡ç†ç•Œé¢ â”‚                   â”‚ â€¢ è½®è¯¢ç‰ˆæœ¬æ–‡ä»¶ â”‚
â”‚ â€¢ è§„åˆ™ç¼–æ’é…ç½® â”‚                   â”‚ â€¢ åŠ è½½å¢é‡æ›´æ–° â”‚
â”‚ â€¢ ç‰ˆæœ¬å‘å¸ƒç®¡ç† â”‚                   â”‚ â€¢ å†…å­˜æ‰§è¡Œè§„åˆ™ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ¶æ„ç‰¹ç‚¹

| ç‰¹ç‚¹ | è¯´æ˜ |
|------|------|
| ğŸš« **æ— æ•°æ®åº“ä¾èµ–** | ä¸éœ€è¦ MySQLï¼Œé…ç½®ä»¥ JSON æ–‡ä»¶å­˜å‚¨ |
| ğŸš« **æ— ä¸­é—´ä»¶ä¾èµ–** | ä¸éœ€è¦ ZooKeeperã€Redis ç­‰ |
| ğŸš« **æ— é•¿è¿æ¥é€šä¿¡** | ä¸éœ€è¦ NIO/Nettyï¼ŒClient é€šè¿‡è½®è¯¢æ–‡ä»¶è·å–æ›´æ–° |
| âœ… **æ–‡ä»¶ç³»ç»ŸåŒæ­¥** | Server å’Œ Client å…±äº«åŒä¸€å­˜å‚¨ç›®å½• |
| âœ… **Docker å‹å¥½** | ä¸€è¡Œå‘½ä»¤å³å¯éƒ¨ç½² |

## æ ¸å¿ƒç»„ä»¶

### Ice Server - è§„åˆ™ç®¡ç†å¹³å°

**åŠŸèƒ½å®šä½**ï¼šå¯è§†åŒ–è§„åˆ™é…ç½®ç®¡ç†ä¸­å¿ƒ

**æ ¸å¿ƒèƒ½åŠ›**ï¼š
- æä¾› Web å¯è§†åŒ–è§„åˆ™é…ç½®ç•Œé¢
- ä»¥ JSON æ–‡ä»¶å­˜å‚¨æ‰€æœ‰è§„åˆ™é…ç½®
- æ”¯æŒè§„åˆ™ç‰ˆæœ¬ç®¡ç†å’Œå†å²å›æº¯
- ç”Ÿæˆå¢é‡æ›´æ–°ä¾› Client æ¶ˆè´¹
- å¤šåº”ç”¨ï¼ˆAppï¼‰éš”ç¦»ç®¡ç†

### Ice Client - è§„åˆ™æ‰§è¡Œå¼•æ“

**åŠŸèƒ½å®šä½**ï¼šä¸šåŠ¡åº”ç”¨çš„è§„åˆ™æ‰§è¡Œæ ¸å¿ƒ

**æ ¸å¿ƒèƒ½åŠ›**ï¼š
- ä»æ–‡ä»¶ç³»ç»ŸåŠ è½½è§„åˆ™é…ç½®åˆ°å†…å­˜
- è½®è¯¢ç‰ˆæœ¬æ–‡ä»¶æ£€æµ‹é…ç½®å˜æ›´
- æä¾›é«˜æ€§èƒ½çš„è§„åˆ™æ‰§è¡Œæ¥å£
- æ”¯æŒå¤šç§èŠ‚ç‚¹ç±»å‹å’Œç¼–æ’æ¨¡å¼
- çº¯å†…å­˜è¿ç®—ï¼Œæ¯«ç§’çº§å“åº”

### å…±äº«å­˜å‚¨ - é…ç½®åŒæ­¥æ¡¥æ¢

**åŠŸèƒ½å®šä½**ï¼šServer å’Œ Client çš„é…ç½®åŒæ­¥åª’ä»‹

**å­˜å‚¨ç»“æ„**ï¼š

```
ice-data/
â”œâ”€â”€ apps/                    # åº”ç”¨é…ç½®
â”‚   â”œâ”€â”€ _id.txt             # ID ç”Ÿæˆå™¨
â”‚   â””â”€â”€ {app}.json          # åº”ç”¨ä¿¡æ¯
â”œâ”€â”€ clients/                 # å®¢æˆ·ç«¯ä¿¡æ¯
â”‚   â””â”€â”€ {app}/
â”‚       â”œâ”€â”€ {address}.json  # å¿ƒè·³æ–‡ä»¶
â”‚       â””â”€â”€ _latest.json    # æœ€æ–°å®¢æˆ·ç«¯
â””â”€â”€ {app}/                   # åº”ç”¨è§„åˆ™
    â”œâ”€â”€ version.txt         # ç‰ˆæœ¬å·
    â”œâ”€â”€ bases/              # Base é…ç½®
    â”œâ”€â”€ confs/              # Conf é…ç½®
    â”œâ”€â”€ versions/           # å¢é‡æ›´æ–°
    â””â”€â”€ history/            # å‘å¸ƒå†å²
```

## é…ç½®åŒæ­¥æµç¨‹

### 1. Server å‘å¸ƒé…ç½®

```
ç”¨æˆ·åœ¨ Web ç•Œé¢ä¿®æ”¹è§„åˆ™
        â†“
ç‚¹å‡»ã€Œå‘å¸ƒã€æŒ‰é’®
        â†“
Server æ›´æ–° bases/ å’Œ confs/ æ–‡ä»¶
        â†“
ç”Ÿæˆå¢é‡æ–‡ä»¶åˆ° versions/
        â†“
æ›´æ–° version.txt ç‰ˆæœ¬å·
```

### 2. Client è½®è¯¢æ›´æ–°

```
Client å®šæœŸæ£€æŸ¥ version.txtï¼ˆé»˜è®¤ 5 ç§’ï¼‰
        â†“
å‘ç°æ–°ç‰ˆæœ¬å·
        â†“
è¯»å– versions/ å¢é‡æ›´æ–°æ–‡ä»¶
        â†“
çƒ­æ›´æ–°å†…å­˜ä¸­çš„è§„åˆ™é…ç½®
```

### 3. å¿ƒè·³æœºåˆ¶

```
Client å®šæœŸå†™å…¥å¿ƒè·³æ–‡ä»¶åˆ° clients/
        â†“
Server è¯»å–å¿ƒè·³æ–‡ä»¶æ„ŸçŸ¥ Client çŠ¶æ€
        â†“
è¶…æ—¶æœªæ›´æ–°çš„ Client è¢«æ ‡è®°ä¸ºç¦»çº¿
```

## éƒ¨ç½²æ–¹å¼

### å•æœºéƒ¨ç½²

æœ€ç®€å•çš„éƒ¨ç½²æ–¹å¼ï¼ŒServer å’Œ Client åœ¨åŒä¸€å°æœºå™¨ï¼š

```bash
# å¯åŠ¨ Server
docker run -d --name ice-server \
  -p 8121:8121 \
  -v ./ice-data:/app/ice-data \
  waitmoon/ice-server:latest

# Client é…ç½®ç›¸åŒè·¯å¾„
ice:
  storage:
    path: ./ice-data
```

### Docker Compose éƒ¨ç½²

```yaml
version: '3.8'
services:
  ice-server:
    image: waitmoon/ice-server:latest
    ports:
      - "8121:8121"
    volumes:
      - ./ice-data:/app/ice-data

  your-app:
    build: .
    volumes:
      - ./ice-data:/app/ice-data  # å…±äº«å­˜å‚¨
    depends_on:
      - ice-server
```

### åˆ†å¸ƒå¼éƒ¨ç½²

å¤šä¸ª Server/Client å®ä¾‹å…±äº«å­˜å‚¨ï¼š

```yaml
services:
  ice-server-1:
    image: waitmoon/ice-server:latest
    volumes:
      - /shared/ice-data:/app/ice-data  # NFS/äº‘ç›˜

  ice-server-2:
    image: waitmoon/ice-server:latest
    volumes:
      - /shared/ice-data:/app/ice-data

  client-1:
    volumes:
      - /shared/ice-data:/app/ice-data

  client-2:
    volumes:
      - /shared/ice-data:/app/ice-data
```

**æ¨èå…±äº«å­˜å‚¨æ–¹æ¡ˆ**ï¼š
- **NFS**ï¼šç½‘ç»œæ–‡ä»¶ç³»ç»Ÿï¼Œé€‚åˆå†…ç½‘ç¯å¢ƒ
- **äº‘ç›˜**ï¼šé˜¿é‡Œäº‘ NASã€AWS EFSã€Azure Files ç­‰
- **åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ**ï¼šGlusterFSã€CephFS ç­‰

## æ€§èƒ½ç‰¹ç‚¹

| ç‰¹æ€§ | è¯´æ˜ |
|------|------|
| **é›¶ç½‘ç»œå¼€é”€** | é…ç½®åŒæ­¥åŸºäºæ–‡ä»¶ç³»ç»Ÿï¼Œæ— ç½‘ç»œé€šä¿¡å»¶è¿Ÿ |
| **çº¯å†…å­˜æ‰§è¡Œ** | è§„åˆ™æ‰§è¡Œå®Œå…¨åœ¨å†…å­˜ä¸­è¿›è¡Œï¼Œæ¯«ç§’çº§å“åº” |
| **å¢é‡æ›´æ–°** | åªåŠ è½½å˜æ›´çš„é…ç½®ï¼Œå‡å°‘èµ„æºæ¶ˆè€— |
| **æ— é”è®¾è®¡** | èŠ‚ç‚¹æ‰§è¡Œäº’ä¸å¹²æ‰°ï¼Œå¤©ç„¶æ”¯æŒé«˜å¹¶å‘ |

## ä¸‹ä¸€æ­¥

- ğŸ“– [å¿«é€Ÿä¸Šæ‰‹](/guide/getting-started.html) - å¼€å§‹æ¥å…¥ Ice
- ğŸ”§ [è¯¦ç»†è¯´æ˜](/guide/detail.html) - æ·±å…¥äº†è§£é…ç½®ç»†èŠ‚
- ğŸ—ï¸ [æ·±å…¥æ¶æ„](/advanced/architecture.html) - æŠ€æœ¯å®ç°åŸç†

